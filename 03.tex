\section{
 Кватернионы и... %не надо писать сюда мать формулы и \ldots
}

\textbf{Кватернионы и вращения $R^3$}

\dfn Обозначим за $\mb H_{1}$ подгруппу кватернионов, по норме равных единице.
\edfn

\rm
Это действительно подгруппа по умножению вследствие мультипликативности нормы.
\erm 

\thrm Отображение $L : \mb H_{1}\to \GL_3(\mb R)$ заданное по правилу $x\to (y \to xyx^{-1})$ корректно определено и даёт сюръективный  гомоморфизм из группы кватернионов единичной нормы в $\SO_3(\mb R)$. Ядро этого гомоморфизма состоит из $\{\pm 1\}$. Точнее, если единичный кватернион $x$  представим в виде $x=a+bv$, {\color{red} где $v$ --- чисто мнимый, $||v|| = 1$}, то соответствующее вращение есть вращение относительно  оси $\lan v \ran$ на угол $2\ffi$, где $\cos \ffi= a$, $\sin \ffi= b$ или тождественное преобразование в случае $v=\pm 1$.
\ethrm
\proof Рассмотрим преобразование $L_x \colon \mb H \to \mb H$ вида $y \to xyx^{-1}$ Прежде всего покажем, что мы получили ортогональное преобразование $\mb R^4$, для этого нужно показать, что оно линейно и сохраняет норму.\\
$L_x(a+b) = x (a+b) x^{-1} = xax^{-1} + xbx^{-1}$\\
$L_x(ka) = xkax^{-1} = kxax^{-1} = kL_x$\\
$||xyx^{-1}||= ||x|| \, ||y|| \, ||x^{-1}|| = ||y|| \, ||x|| \, ||x||^{-1} =||y||.$\\
\\
Теперь заметим, что преобразование $L_x$ сохраняет на месте вектор 1: $x \, 1 \, x^{-1} = 1$. Следовательно, сохраняет его ортогональное дополнение, то есть $\mb R^3$. Таким образом $L_x$ ограничивается на $\mb R^3$.\\
\\
Гомоморфизм: $L_xL_y= yx \, v \, x^{-1} y^{-1} = L_{xy}$.\\ 
\\
Тем самым мы доказали, что $L$ --- гомоморфизм и задаёт ортогональные преобразования в $\mb R^3$.\\ 
\\
Ось вращения: заметим, что если $t=a+bv, t \in \mb H_1$, то $L_{t}$ оставляет $v$ на месте. Действительно, при $b\neq 0$ \\
$tvt^{-1}=t(\frac{t-a}{b})t^{-1}= \frac{ttt^{-1} - tat^{-1}}{b} =  \frac{t-a}{b}=v.$\\
\\
Пусть теперь $v = (x, y, z) \in H_1$. Тогда заметим, что $1 = ||t||^2 = ||a + bv||^2 = a^2 + b^2(x^2 + y^2 + z^2) = a^2 + b^2 ||v|| ^ 2 = a^2 + b^2$\\
Отсюда $|a|, |b| \le 1, a^2 + b^2 = 1 \to a = \cos \varphi, b = \sin \varphi$ для некоторого $\varphi$.\\ 
\\
Рассмотрим нормированный вектор $u\bot v$ и $[v,u] \bot u$, которые образуют ортонормированный базис $\mb R^2$ дополнения и посчитаем $tut^{-1}$ и $t[v, u] t^{-1}$. \\
\rm 
Если $x \bot y, x,y$ --- чисто мнимые, то $xy = -\lan x, y \ran + [x, y] = [x, y]$\\
Если $x \in H_1$, то $x^{-1} = \frac{\ovl{x}}{||x||} = \ovl{x}$\\
Если $x$ чисто мнимый, то $x^2 = -\lan x, x \ran + [x, x] = -||x||$\\
Если $x$ чисто мнимый, то $||a + bx|| = a^2 + b^2||x||$ (доказано выше)\\
\erm 
$tut^{-1}=(a+bv)u(a-bv)= (a+bv)(au-b[u,v])=a^2u -ab[u,v]+ab[v,u]- b^2 v[u,v] {\color{red}=}$\\
$-v[u,v] = v[v, u] = vvu = -||v||^2 u = -u$\\
${\color{red}=} a^2u +2ab[v,u]- b^2u = (a^2 - b^2) u - 2ab[u, v]$\\
Заметим, что $a^2 - b^2 = \cos^2 \varphi - \sin^2 \varphi = \cos 2\varphi$\\
$2ab = \sin 2\varphi$\\
$u \to \cos 2\varphi \, u + \sin 2\varphi \, [v, u]$\\
\\
$t[v,u]t^{-1} = (a + bv)[v, u](a - bv) = (a + bv)(vua + buvv) = (a + bv)([v, u] a - bu) = a^2 [v, u] - b^2 [v, u] - abu + ab vvu = (a^2 - b^2) [v, u] - 2abu = -\sin 2\varphi u + \cos 2\varphi [v, u]$\\
\\
Посмотрим на определитель матрицы перехода между базисами, он равен $\cos^2 2\varphi + \sin^2 2\varphi = 1$. Тем самым данное преобразование является поворотом по определению.\\
\\
Посмотрим на $\cos$ угла между $u$ и $L_t(u)$. По определению $\cos(u, L_t(u)) = \frac{\lan u, \cos 2\varphi \, u + \sin 2\varphi [v, u] \ran}{||u|| ||\cos 2\varphi \, u + \sin 2\varphi||} = \frac{\lan u, \cos 2\varphi \, u \ran + \lan u, \sin 2 \varphi [v, u] \, \ran}{||u(\cos 2\varphi \, u + \sin 2\varphi \, [v, u])||} = \frac{\cos 2\varphi \, ||u|| ^ 2}{||-\cos 2\varphi + \sin 2\varphi v||} = \frac{\cos 2\varphi}{\cos^2 2\varphi + \sin^2 2\varphi ||v||} = \frac{\cos 2\varphi}{\cos^2 2\varphi + \sin^2 2\varphi} = \cos 2\varphi$\\
\\
Тем самым вектор действительно повернулся на угол $2 \varphi$.\\
\\
Наконец, сюръективность: пусть хотим поворот относительно оси $t$ на угол $2\varphi$. Сначала нормируем $t = \frac{t'}{||t||}$, затем берём $a = \cos \varphi, b = \sin \varphi$, тогда, по доказанному ранее, для $x = a + bt'$, $L_x$ --- искомый поворот.\\  
\\
По поводу $u = \pm 1$ заметим, что в таком случае $t = a + bu = \pm 1$ ($t$ по норме равен 1 и чисто вещественный). В таком случае $\sin \varphi = \pm 1, 2\varphi = 0 \text{ или }2\pi$.\\
\endproof

Данная задача не требуется в билете, но пусть будет.\\
\zd
Покажите, что отображение $(x,y) \to (z \to xzy^{-1})$ задаёт сюръективный гомоморфизм из декартового квадрата группы единичных кватернионов в группу $\SO_4(\mb R)$ с ядром $\{(1,1),(-1,-1)\}$.
\ezd

На практике мы доказали {\color{red}TODO Написать доказательство}, что $\forall f \in SO4$ имеет вид $f(x) = ax\overline{b}, ||a|| = ||b|| = 1$\\
Поэтому если взять отображение $H_1 \times H_1 \to SO4$ по правилу $(a, b) \to (x \to a x \overline{b})$ получим сюръективное отображение. Проверим гомоморфизм, $f((a,b) \cdot (c,d)) = f(a\cdot c, b \cdot d) = (x \to ac \, x \, \overline{bd}) = (x \to ac \, x \, \overline{d}\, \,\overline{b}) = (x \to a(c \, x \, \overline{d})\overline{b}) = f(a,b) \circ f(c,d)$\\
\\
Осталось найти ядро. $(a,b) : \forall x, ax\overline{b} = x$\\
$b,a \ne 0$ т.к. $b, a \in H_1$\\
$\overline{b} = b^{-1}$\\
Пусть $x = 1$, получаем $ab^{-1} = 1$\\
$a = b$\\
\\
Но из лекции мы знаем, что отображение вида $x \to axa^{-1}, a \in H_1$ является гомоморфизмом с ядром $\pm 1$, таким образом ядром нашего отображения будет $(1, 1)$ и $(-1, -1)$\\
\\